#include <bits/stdc++.h>

#include "../headers/Ler.h"

using namespace std;



Ler lfile;
Graph g;

void clearScreen() {
    for (int i = 0; i < 100; i++) {
        cout << endl;
    }
}

void wait() {
    cout << endl;
    int c; do c = getchar(); while ((c != '\n') && (c != EOF));
    cout << "Pressione ENTER para continuar...";
    cout << endl;
    do{ c = getchar(); }while ((c != '\n') && (c != EOF));
}

bool checkInteiro(const string& x);


int main(){
    system("Color 09");
    lfile.ler_aeroportos();
    g = Graph((int) lfile.getAeroportos().size());
    cout << "Aeroportos: " << lfile.getAeroportos().size() << endl;
    cout << "Nos: "<<g.nodes.size() << endl;
    lfile.ler_companhias();
    lfile.ler_voos(g);

    int sum_edges = 0;
    int sum_airlines = 0;

    for(const auto& nd : g.nodes){
        for(const auto& ed : nd.adj){
            sum_edges++;
            sum_airlines += ed.airlines.size();
        }
    }

    cout << "Edges: " << sum_edges << endl;
    cout << "Voos: " << sum_airlines << endl;

    int choice;
    string op_menu;

    do {
        clearScreen();
        cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
        cout << "||------------------------ MENU -------------------------||" << endl;
        cout << "|| Escolha uma opcao:                                    ||" << endl;
        cout << "||_______________________________________________________||" << endl;
        cout << "||                                                       ||" << endl;
        cout << "||   1 - Informacoes                                     ||" << endl;
        cout << "||   2 - Pesquisa                                        ||" << endl;
        cout << "||   3 - EstatÃ­sticas                                    ||" << endl;
        cout << "||                                                       ||" << endl;
        cout << "||   0 - Sair                                            ||" << endl;
        cout << "||                                                       ||" << endl;
        cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
        cout << endl;



        cin >> op_menu;

        while(!checkInteiro(op_menu) || stoi(op_menu) < 0 || stoi(op_menu) > 3){
            cout << endl;
            cout << "Opcao invalida! Tente novamente: ";
            cin >> op_menu;
            cout << endl;
        }

        choice = stoi(op_menu);
        cout << endl;

        switch (choice) {

            case 0:

                choice = 0;
                break;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

            case 1:

                int ch1;
                choice = 1;

                do{
                    clearScreen();
                    cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                    cout << "||------------------------ INFO -------------------------||" << endl;
                    cout << "|| Escolha uma opcao:                                    ||" << endl;
                    cout << "||_______________________________________________________||" << endl;
                    cout << "||                                                       ||" << endl;
                    cout << "||   1 - De um Aeroporto                                 ||" << endl;
                    cout << "||   2 - De uma Cidade                                   ||" << endl;
                    cout << "||   3 - De um Pais                                      ||" << endl;
                    cout << "||   4 - De um raio de X Km de uma coordenada            ||" << endl;
                    cout << "||                                                       ||" << endl;
                    cout << "||   0 - Sair                                            ||" << endl;
                    cout << "||                                                       ||" << endl;
                    cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                    cout << endl;

                    cin >> op_menu;

                    while(!checkInteiro(op_menu) || stoi(op_menu) < 0 || stoi(op_menu) > 4){
                        cout << endl;
                        cout << "Opcao invalida! Tente novamente: ";
                        cin >> op_menu;
                        cout << endl;
                    }

                    ch1 = stoi(op_menu);

                } while (ch1 != 0);
                break;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

            case 2:

                int ch2;
                choice = 2;

                do{
                    clearScreen();
                    cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                    cout << "||---------------------- PESQUISA -----------------------||" << endl;
                    cout << "|| Escolha uma opcao:                                    ||" << endl;
                    cout << "||_______________________________________________________||" << endl;
                    cout << "||                                                       ||" << endl;
                    cout << "||   1 - Rota com menos escalas                          ||" << endl;
                    cout << "||   2 - Rota com menos distancia percorrida             ||" << endl;
                    cout << "||                                                       ||" << endl;
                    cout << "||   0 - Sair                                            ||" << endl;
                    cout << "||                                                       ||" << endl;
                    cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                    cout << endl;

                    cin >> op_menu;

                    while(!checkInteiro(op_menu) || stoi(op_menu) < 0 || stoi(op_menu) > 2){
                        cout << endl;
                        cout << "Opcao invalida! Tente novamente: ";
                        cin >> op_menu;
                        cout << endl;
                    }

                    ch2 = stoi(op_menu);

                    switch (ch2) {

                        case 0:

                            ch2 = 0;
                            break;
/*---------------------------------------------------------------------------------------------------------------------------------------*/
                        case 1:

                            ch2 = 1;
                            int ch2_1;

                            do{
                                clearScreen();
                                cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                                cout << "||---------------------- PESQUISA -----------------------||" << endl;
                                cout << "|| Origem do Voo:                        (Menos Escalas) ||" << endl;
                                cout << "||_______________________________________________________||" << endl;
                                cout << "||                                                       ||" << endl;
                                cout << "||   1 - Um Aeroporto                                    ||" << endl;
                                cout << "||   2 - Uma Cidade                                      ||" << endl;
                                cout << "||   3 - Um Pais                                         ||" << endl;
                                cout << "||   4 - O ponto mais proximo de umas coordenadas        ||" << endl;
                                cout << "||   5 - Todos os pontos num raio de X Km                ||" << endl;
                                cout << "||                                                       ||" << endl;
                                cout << "||   0 - Sair                                            ||" << endl;
                                cout << "||                                                       ||" << endl;
                                cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                                cout << endl;

                                cin >> op_menu;

                                while(!checkInteiro(op_menu) || stoi(op_menu) < 0 || stoi(op_menu) > 5){
                                    cout << endl;
                                    cout << "Opcao invalida! Tente novamente: ";
                                    cin >> op_menu;
                                    cout << endl;
                                }

                                ch2_1 = stoi(op_menu);

                            } while (ch2_1 != 0);

                            break;
/*---------------------------------------------------------------------------------------------------------------------------------------*/
                        case 2:

                            ch2 = 2;
                            int ch2_2;

                            do{
                                clearScreen();
                                cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                                cout << "||---------------------- PESQUISA -----------------------||" << endl;
                                cout << "|| Origem do Voo:                      (Menos Distancia) ||" << endl;
                                cout << "||_______________________________________________________||" << endl;
                                cout << "||                                                       ||" << endl;
                                cout << "||   1 - Um Aeroporto                                    ||" << endl;
                                cout << "||   2 - Uma Cidade                                      ||" << endl;
                                cout << "||   3 - Um Pais                                         ||" << endl;
                                cout << "||   4 - O ponto mais proximo de umas coordenadas        ||" << endl;
                                cout << "||   5 - Todos os pontos num raio de X Km                ||" << endl;
                                cout << "||                                                       ||" << endl;
                                cout << "||   0 - Sair                                            ||" << endl;
                                cout << "||                                                       ||" << endl;
                                cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                                cout << endl;

                                cin >> op_menu;

                                while(!checkInteiro(op_menu) || stoi(op_menu) < 0 || stoi(op_menu) > 5){
                                    cout << endl;
                                    cout << "Opcao invalida! Tente novamente: ";
                                    cin >> op_menu;
                                    cout << endl;
                                }

                                ch2_2 = stoi(op_menu);

                            } while (ch2_2 != 0);

                            break;
/*---------------------------------------------------------------------------------------------------------------------------------------*/
                        default:
                            clearScreen();
                            cout << "Opcao invalida!" << endl;
                            wait();
                            break;
                    }

                } while (ch2 != 0);

                break;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

            case 3:

                choice = 3;
                int ch3;

                do{
                    clearScreen();
                    cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                    cout << "||-------------------- ESTATISTICAS ---------------------||" << endl;
                    cout << "|| Escolha uma opcao:                                    ||" << endl;
                    cout << "||_______________________________________________________||" << endl;
                    cout << "||                                                       ||" << endl;
                    cout << "||   1 - Globais                                         ||" << endl;
                    cout << "||   2 - De um Pais                                      ||" << endl;
                    cout << "||   3 - De uma Cidade                                   ||" << endl;
                    cout << "||   4 - De um Aeroporto                                 ||" << endl;
                    cout << "||   5 - Pontos de Articulacao                           ||" << endl;
                    cout << "||   6 - Componentes Fortemente Conexos                  ||" << endl;
                    cout << "||                                                       ||" << endl;
                    cout << "||   0 - Sair                                            ||" << endl;
                    cout << "||                                                       ||" << endl;
                    cout << "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||" << endl;
                    cout << endl;

                    cin >> op_menu;

                    while(!checkInteiro(op_menu) || stoi(op_menu) < 0 || stoi(op_menu) > 6){
                        cout << endl;
                        cout << "Opcao invalida! Tente novamente: ";
                        cin >> op_menu;
                        cout << endl;
                    }

                    ch3= stoi(op_menu);

                } while (ch3 != 0);

                break;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

            default:
                clearScreen();
                cout << "Opcao invalida!" << endl;
                wait();
                break;
        }


    } while (choice != 0);


    return 0;
}


bool checkInteiro(const string& s){

    for(auto y : s){
        if(!isdigit(y)){
            return false;
        }
    }
    return true;
}